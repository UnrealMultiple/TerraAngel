using TerraAngel.Net;

namespace TerraAngel.Tools.Exploit;

public class MsgUpdateSign : Tool
{
    public override string Name => GetString("Msg Update Sign");
    public override ToolTabs Tab => ToolTabs.MiscTools;

    public bool IsExploiting;
    public TimerSlim SendTimer = new(10.0f, TimerSlim.TimeBy.DrawDeltaTime, true);

    public override void DrawUI(ImGuiIOPtr io)
    {
        if (ImGui.CollapsingHeader(GetString("Msg Update Sign")))
        {
            ImGui.Text(GetString($"Remaining Time For Next Exploit: {SendTimer.RemainingTime: 0.0}s"));
            ImGui.Checkbox(GetString("Exploit Current Sign"), ref IsExploiting);
        }
    }

    public override void Update()
    {
        if (!IsExploiting || Main.player[Main.myPlayer].sign is not (>= 0 and < Sign.maxSigns))
        {
            SendTimer.Reset(true);
            return;
        }

        if (!SendTimer.TickTock())
            return;

        SpecialNetMessage.SendUpdateSignExploit(Main.player[Main.myPlayer].sign, 1000);
    }
}